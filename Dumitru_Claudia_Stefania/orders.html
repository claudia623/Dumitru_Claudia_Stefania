<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Istoric comenzi</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="site-layout">
  <header>
    <h1>Magazin de Plușuri Croșetate</h1>
  </header>
  <nav>
    <div class="nav-center">
      <a href="index.html">Acasă</a>
      <a href="produse.html">Produse</a>
      <a href="contact.html">Contact</a>
    </div>
    <div class="nav-right">
      <a href="cart.html" class="cart-icon" title="Coș de cumpărături">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M7 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM7.16 16h9.68c.8 0 1.5-.48 1.8-1.22l3.24-7.24A1 1 0 0 0 21 6H6.21l-.94-2.36A1 1 0 0 0 4.34 2H1v2h2.34l3.6 9.03-1.35 2.44C4.52 16.37 5.48 18 7 18h12v-2H7.42a.25.25 0 0 1-.22-.13l.96-1.87z"/></svg>
        <span class="cart-badge" id="cart-badge" style="display:none">0</span>
      </a>
      <a href="login.html" class="login-link">Login</a>
    </div>
  </nav>

  <main class="container" style="max-width:900px">
    <h2>Istoric comenzi</h2>
    <div id="orders-root" style="margin-top:16px"></div>
  </main>

  <aside>
      <div class="newsletter-box" style="padding:15px; background:rgba(212,99,122,0.05); border-radius:10px; margin-top:20px;">
          <h4 style="margin-top:0">Newsletter</h4>
          <p style="font-size:0.9rem">Abonează-te pentru a afla când adaug plușuri noi!</p>
          <input type="email" placeholder="email@exemplu.com" style="margin-bottom:8px">
          <button class="add-btn" style="width:100%">Abonează-te</button>
      </div>
  </aside>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-about"><h4>Despre noi</h4><p>Plușuri croșetate manual.</p></div>
        <div class="footer-contact"><h4>Contact</h4><p>Email: <a href="mailto:plusuricrosetate@email.com">plusuricrosetate@email.com</a></p></div>
        <div class="footer-links"><h4>Link-uri</h4><p><a href="produse.html">Produse</a></p></div>
      </div>
    </div>
  </footer>

  <script src="favorites.js"></script>
  <script src="products-api.js"></script>
  <script src="cart.js"></script>
  <script src="auth-api.js"></script>
  <script src="site-ui.js"></script>
  <script>
    (function(){
      function fmtDate(ts){ try{ var d=new Date(ts); return d.toLocaleString(); }catch(e){ return '';} }
      document.addEventListener('DOMContentLoaded', function(){
        var u = window.auth && window.auth.getCurrentUser && window.auth.getCurrentUser();
        if(!u){ window.location.href = 'login.html'; return; }
        var root = document.getElementById('orders-root');
        if(!window.productsAPI || !window.productsAPI.getOrders){ root.innerHTML = '<p class="muted">Comenzile nu pot fi încărcate.</p>'; return; }
        window.productsAPI.getOrders().then(function(orders){
          if(!orders || !orders.length){ root.innerHTML = '<p class="muted">Nu ai comenzi înregistrate.</p>'; return; }
          var html = '<div class="login-section" style="overflow:auto">';
          html += '<table class="cart-list"><thead><tr><th>#</th><th>Data</th><th>Status</th><th>Total</th></tr></thead><tbody>';
          orders.forEach(function(o){
            var id = o.id_comanda || o.id || '-';
            var date = o.data_comanda || o.created_at || '';
            var total = o.total || o.total_produse || 0;
            var status = o.status || '';
            html += '<tr><td>'+ id +'</td><td>'+ fmtDate(date) +'</td><td>'+ status +'</td><td>'+ total +' lei</td></tr>';
          });
          html += '</tbody></table></div>';
          root.innerHTML = html;
        }).catch(function(err){ root.innerHTML = '<p style="color:red">Eroare la încărcarea comenzilor.</p>'; console.error(err); });
      });
    })();
  </script>
</body>
</html>
