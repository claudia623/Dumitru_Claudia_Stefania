<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Date personale</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="site-layout">
  <header>
    <h1>Magazin de Plușuri Croșetate</h1>
  </header>
  <nav>
    <div class="nav-center">
      <a href="index.html">Acasă</a>
      <a href="produse.html">Produse</a>
      <a href="contact.html">Contact</a>
    </div>
    <div class="nav-right">
      <a href="cart.html" class="cart-icon" title="Coș de cumpărături">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M7 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM7.16 16h9.68c.8 0 1.5-.48 1.8-1.22l3.24-7.24A1 1 0 0 0 21 6H6.21l-.94-2.36A1 1 0 0 0 4.34 2H1v2h2.34l3.6 9.03-1.35 2.44C4.52 16.37 5.48 18 7 18h12v-2H7.42a.25.25 0 0 1-.22-.13l.96-1.87z"/></svg>
        <span class="cart-badge" id="cart-badge" style="display:none">0</span>
      </a>
      <a href="login.html" class="login-link">Login</a>
    </div>
  </nav>

  <main class="container" style="max-width:720px">
    <h2>Profil</h2>
    <p class="muted">completează-ți datele pentru facturare și livrare</p>
    <section class="login-section" style="margin-top:16px">
      <form id="profile-form">
        <h3>Cont</h3>
        <div class="field">
          <label for="pf-username">Nume utilizator</label>
          <input type="text" id="pf-username" disabled>
        </div>
        <div class="field">
          <label for="pf-email">Email</label>
          <input type="email" id="pf-email" disabled>
        </div>
        <div class="field">
          <label for="pf-phone">Telefon</label>
          <input type="tel" id="pf-phone" placeholder="07xx xxx xxx">
        </div>
        <h3 style="margin-top:14px">Adresa de livrare</h3>
        <div class="field">
          <label for="addr-name">Nume destinatar</label>
          <input type="text" id="addr-name" placeholder="Nume Prenume">
        </div>
        <div class="field">
          <label for="addr-street">Stradă</label>
          <input type="text" id="addr-street" placeholder="Str. Exemplu">
        </div>
        <div class="form-grid-2">
          <div class="field">
            <label for="addr-number">Număr</label>
            <input type="text" id="addr-number" placeholder="Nr.">
          </div>
          <div class="field">
            <label for="addr-extra">Bloc / Scara / Ap.</label>
            <input type="text" id="addr-extra" placeholder="Bloc A, Sc. 1, Ap. 10">
          </div>
        </div>
        <div class="form-grid-2">
          <div class="field">
            <label for="addr-city">Oraș</label>
            <input type="text" id="addr-city" placeholder="Oraș">
          </div>
          <div class="field">
            <label for="addr-county">Județ</label>
            <input type="text" id="addr-county" placeholder="Județ">
          </div>
        </div>
        <div class="form-grid-2">
          <div class="field">
            <label for="addr-zip">Cod poștal</label>
            <input type="text" id="addr-zip" placeholder="Cod poștal">
          </div>
          <div class="field">
            <label for="addr-country">Țară</label>
            <input type="text" id="addr-country" placeholder="România">
          </div>
        </div>
        <button type="submit" style="margin-top:12px">Salvează</button>
      </form>
    </section>
  </main>

  <aside>
      <div class="newsletter-box" style="padding:15px; background:rgba(212,99,122,0.05); border-radius:10px; margin-top:20px;">
          <h4 style="margin-top:0">Newsletter</h4>
          <p style="font-size:0.9rem">Abonează-te pentru a afla când adaug plușuri noi!</p>
          <input type="email" placeholder="email@exemplu.com" style="margin-bottom:8px">
          <button class="add-btn" style="width:100%">Abonează-te</button>
      </div>
  </aside>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-about"><h4>Despre noi</h4><p>Plușuri croșetate manual.</p></div>
        <div class="footer-contact"><h4>Contact</h4><p>Email: <a href="mailto:plusuricrosetate@email.com">plusuricrosetate@email.com</a></p></div>
        <div class="footer-links"><h4>Link-uri</h4><p><a href="produse.html">Produse</a></p></div>
      </div>
    </div>
  </footer>

  <script src="favorites.js"></script>
  <script src="cart.js"></script>
  <script src="auth-api.js"></script>
  <script src="site-ui.js"></script>
  <script>
    (function(){
      function key(uid){ return 'profile_' + uid; }
      function load(uid){ try{ return JSON.parse(localStorage.getItem(key(uid))||'{}'); }catch(e){ return {}; } }
      function save(uid, data){ localStorage.setItem(key(uid), JSON.stringify(data)); }
      function toast(m){ try{ window.dispatchEvent(new CustomEvent('siteToast',{detail:{message:m, position:'center'}})); }catch(e){} }
      document.addEventListener('DOMContentLoaded', function(){
        var u = window.auth && window.auth.getCurrentUser && window.auth.getCurrentUser();
        if(!u){ window.location.href = 'login.html'; return; }
        var pf = load(u.id);
        document.getElementById('pf-username').value = u.username || '';
        document.getElementById('pf-email').value = u.email || '';
        document.getElementById('pf-phone').value = pf.phone || '';
        document.getElementById('addr-name').value = (pf.address && pf.address.name) || '';
        document.getElementById('addr-street').value = (pf.address && pf.address.street) || '';
        document.getElementById('addr-number').value = (pf.address && pf.address.number) || '';
        document.getElementById('addr-extra').value = (pf.address && pf.address.extra) || '';
        document.getElementById('addr-city').value = (pf.address && pf.address.city) || '';
        document.getElementById('addr-county').value = (pf.address && pf.address.county) || '';
        document.getElementById('addr-zip').value = (pf.address && pf.address.zip) || '';
        document.getElementById('addr-country').value = (pf.address && pf.address.country) || '';

        document.getElementById('profile-form').addEventListener('submit', function(e){
          e.preventDefault();
          var data = {
            phone: document.getElementById('pf-phone').value.trim(),
            address: {
              name: document.getElementById('addr-name').value.trim(),
              street: document.getElementById('addr-street').value.trim(),
              number: document.getElementById('addr-number').value.trim(),
              extra: document.getElementById('addr-extra').value.trim(),
              city: document.getElementById('addr-city').value.trim(),
              county: document.getElementById('addr-county').value.trim(),
              zip: document.getElementById('addr-zip').value.trim(),
              country: document.getElementById('addr-country').value.trim() || 'România'
            }
          };
          save(u.id, data);
          toast('Date salvate.');
        });
      });
    })();
  </script>
</body>
</html>
