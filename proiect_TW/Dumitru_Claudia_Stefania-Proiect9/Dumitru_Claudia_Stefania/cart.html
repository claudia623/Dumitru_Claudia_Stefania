<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coșul de cumpărături</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Magazin de Plușuri Croșetate</h1>
        <nav>
            <div class="nav-center">
                <a href="index.html">Acasă</a>
                <a href="produse.html">Produse</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="nav-right">
                <a href="cart.html" class="cart-icon" title="Coș de cumpărături">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M7 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM7.16 16h9.68c.8 0 1.5-.48 1.8-1.22l3.24-7.24A1 1 0 0 0 21 6H6.21l-.94-2.36A1 1 0 0 0 4.34 2H1v2h2.34l3.6 9.03-1.35 2.44C4.52 16.37 5.48 18 7 18h12v-2H7.42a.25.25 0 0 1-.22-.13l.96-1.87z"/></svg>
                    <span class="cart-badge" id="cart-badge">0</span>
                </a>
                <a href="login.html" class="login-link">Login</a>
            </div>
        </nav>
    </header>
    <main>
        <div class="cart-wrapper">
            <section class="cart-card">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="#e0b7b7" style="display:block;margin:0 auto 10px auto;"><path d="M7 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM7.16 16h9.68c.8 0 1.5-.48 1.8-1.22l3.24-7.24A1 1 0 0 0 21 6H6.21l-.94-2.36A1 1 0 0 0 4.34 2H1v2h2.34l3.6 9.03-1.35 2.44C4.52 16.37 5.48 18 7 18h12v-2H7.42a.25.25 0 0 1-.22-.13l.96-1.87z"/></svg>
                <h2 style="color:#b97a7a;">Coșul tău de cumpărături</h2>
                <div id="cart-contents">
                    <p style="color:#7d4c4c;" id="cart-empty">Se încarcă coșul...</p>
                </div>
                <div style="text-align:center;margin-top:12px;"><button id="clear-cart" style="background:#b97a7a;color:#fff;border:none;padding:8px 12px;border-radius:8px;">Golește coșul</button></div>
            </section>
        </div>
        
        <script src="cart.js"></script>
        <script src="site-ui.js"></script>
        <script>
            function renderCart(){
                var contents = document.getElementById('cart-contents');
                var cart = window.cartAPI.getCart();
                var clearBtn = document.getElementById('clear-cart');
                if(!cart || cart.length === 0){
                    contents.innerHTML = '<p style="color:#7d4c4c;">Coșul este gol.</p>';
                    if(clearBtn) clearBtn.style.display = 'none';
                    return;
                }
                var html = '<ul class="cart-list">';
                var total = 0;
                cart.forEach(function(it){
                    total += it.price * (it.qty||1);
                    html += '<li class="cart-item"> <img src="'+it.image+'" alt="" style="width:60px;height:60px;border-radius:8px;margin-right:10px;"> <strong>'+it.title+'</strong> <div> <button class="dec" data-id="'+it.id+'">-</button> <span class="qty">'+(it.qty||1)+'</span> <button class="inc" data-id="'+it.id+'">+</button> </div> <div>'+it.price+' lei</div> <button class="remove" data-id="'+it.id+'">Șterge</button></li>';
                });
                html += '</ul>';
                html += '<div style="text-align:right;margin-top:12px;"><strong>Total: '+total+' lei</strong></div>';
                contents.innerHTML = html;
                if(clearBtn) clearBtn.style.display = 'inline-block';
                document.querySelectorAll('.remove').forEach(function(b){ b.addEventListener('click', function(){ window.cartAPI.removeItem(b.dataset.id); }); });
                document.querySelectorAll('.inc').forEach(function(b){ b.addEventListener('click', function(){ window.cartAPI.updateQty(b.dataset.id, (Number(b.previousElementSibling.innerText)||0)+1); }); });
                document.querySelectorAll('.dec').forEach(function(b){ b.addEventListener('click', function(){ var qEl = b.nextElementSibling; var q = Number(qEl.innerText||'1'); if(q>1) window.cartAPI.updateQty(b.dataset.id, q-1); }); });
            }

            window.addEventListener('cartUpdated', function(){ renderCart(); });

            document.getElementById('clear-cart').addEventListener('click', function(){
                if(window.siteUI && window.siteUI.confirm){
                    window.siteUI.confirm('Sigur vrei să golești coșul?').then(function(yes){ if(yes){ window.cartAPI.clearCart(); window.siteUI.notifyToast('Coșul a fost golit', 'center'); } else { window.siteUI.notifyToast('Acțiune anulată', 'center'); } });
                }else{
                    // As a last resort (very old browsers), use native confirm
                    window.cartAPI.clearCart();
                }
            });

            // initial render
            renderCart();
        </script>
    </main>
    <script src="site-ui.js"></script>
    <footer>
        <p>&copy; 2025 Magazin Plușuri Croșetate. Toate drepturile rezervate.</p>
    </footer>
</body>
</html>
</body>
</html>
